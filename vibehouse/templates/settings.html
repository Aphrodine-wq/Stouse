{% extends "base.html" %}
{% block title %}Settings â€” VibeHouse{% endblock %}

{% block body %}
<div class="page-container fade-in-up">
  <div class="page-header">
    <h1>Settings</h1>
  </div>

  <!-- Profile section -->
  <div class="ios-card">
    <h3>Profile</h3>
    <form id="profileForm">
      <div class="form-group">
        <label>Full Name</label>
        <input type="text" id="fullName" placeholder="Your name">
      </div>
      <div class="form-group">
        <label>Email</label>
        <input type="email" id="userEmail" placeholder="you@example.com" disabled>
      </div>
      <div class="form-group">
        <label>Phone</label>
        <input type="tel" id="userPhone" placeholder="+1 (555) 123-4567">
      </div>
      <div class="form-group">
        <label>Role</label>
        <input type="text" id="userRole" disabled>
      </div>
      <button type="submit" class="btn btn-primary">Save Changes</button>
    </form>
  </div>

  <!-- Notification preferences -->
  <div class="ios-card">
    <h3>Notifications</h3>
    <div class="settings-list">
      <div class="settings-item">
        <div>
          <div class="settings-label">Email Notifications</div>
          <div class="settings-desc text-footnote text-secondary">Receive project updates via email</div>
        </div>
        <label class="ios-toggle"><input type="checkbox" checked><span class="toggle-slider"></span></label>
      </div>
      <div class="settings-item">
        <div>
          <div class="settings-label">SMS Notifications</div>
          <div class="settings-desc text-footnote text-secondary">Get text alerts for urgent updates</div>
        </div>
        <label class="ios-toggle"><input type="checkbox"><span class="toggle-slider"></span></label>
      </div>
      <div class="settings-item">
        <div>
          <div class="settings-label">Daily Reports</div>
          <div class="settings-desc text-footnote text-secondary">Receive daily project status emails</div>
        </div>
        <label class="ios-toggle"><input type="checkbox" checked><span class="toggle-slider"></span></label>
      </div>
      <div class="settings-item">
        <div>
          <div class="settings-label">Bid Alerts</div>
          <div class="settings-desc text-footnote text-secondary">Notify when new bids are received</div>
        </div>
        <label class="ios-toggle"><input type="checkbox" checked><span class="toggle-slider"></span></label>
      </div>
    </div>
  </div>

  <!-- Danger zone -->
  <div class="ios-card">
    <h3 style="color: var(--sys-red);">Account</h3>
    <button class="btn btn-secondary" onclick="logout()" style="color: var(--sys-red);">Sign Out</button>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
const token = localStorage.getItem('access_token');
if (!token) window.location.href = '/login';

async function loadProfile() {
  try {
    const user = JSON.parse(localStorage.getItem('user') || '{}');
    document.getElementById('fullName').value = user.full_name || '';
    document.getElementById('userEmail').value = user.email || '';
    document.getElementById('userPhone').value = user.phone || '';
    document.getElementById('userRole').value = (user.role || '').charAt(0).toUpperCase() + (user.role || '').slice(1);
  } catch (e) {}
}

function logout() {
  localStorage.removeItem('access_token');
  localStorage.removeItem('refresh_token');
  localStorage.removeItem('user');
  window.location.href = '/';
}

loadProfile();
</script>
{% endblock %}
